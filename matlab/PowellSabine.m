function B = PowellSabine(T,u,w,r,f,Df)
%POWELLSABINE Summary of this function goes here
%   Detailed explanation goes here

V1 = T(1,:);
V2 = T(2,:);
V3 = T(3,:);

w1 = w(1,:);
w2 = w(2,:);
w3 = w(3,:);

B = cell(1,6);

for i = 1:6
    B{1,i} = nan(3,3);
end

c1 = f(V1(1),V1(2));
c2 = f(V2(1),V2(2));
c3 = f(V3(1),V3(2));
c4 = c1 + 1/2*dot(Df(V1(1),V1(2)),w1-V1);
c5 = c1 + 1/2*dot(Df(V1(1),V1(2)),u-V1);
c6 = c1 + 1/2*dot(Df(V1(1),V1(2)),w3-V1);
c7 = c2 + 1/2*dot(Df(V2(1),V2(2)),w2-V2);
c8 = c2 + 1/2*dot(Df(V2(1),V2(2)),u-V2);
c9 = c2 + 1/2*dot(Df(V2(1),V2(2)),w1-V2);
c10 = c3 + 1/2*dot(Df(V3(1),V3(2)),w2-V3);
c11 = c3 + 1/2*dot(Df(V3(1),V3(2)),u-V3);
c12 = c3 + 1/2*dot(Df(V3(1),V3(2)),w3-V3);
c13 = r(1,1)*c4 + r(1,2)*c9;
c14 = r(2,1)*c7 + r(2,2)*c10;
c15 = r(3,1)*c12 + r(3,2)*c6;
c16 = r(1,1)*c5 + r(1,2)*c8;
c17 = r(2,1)*c8 + r(2,2)*c11;
c18 = r(3,1)*c11 + r(3,2)*c5;

v = pointbary(u,T);

c19 = v(1)*c5 + v(2)*c8 + v(3)*c11;

B{1,1}(1,1) = c1;
B{1,1}(1,2) = c4;
B{1,1}(2,1) = c5;
B{1,1}(1,3) = c13;
B{1,1}(3,1) = c19;
B{1,1}(2,2) = c16;

B{1,2}(1,1) = c13;
B{1,2}(1,2) = c9;
B{1,2}(2,1) = c16;
B{1,2}(1,3) = c2;
B{1,2}(3,1) = c19;
B{1,2}(2,2) = c8;

B{1,3}(1,1) = c2;
B{1,3}(1,2) = c7;
B{1,3}(2,1) = c8;
B{1,3}(1,3) = c14;
B{1,3}(3,1) = c19;
B{1,3}(2,2) = c17;

B{1,4}(1,1) = c14;
B{1,4}(1,2) = c10;
B{1,4}(2,1) = c17;
B{1,4}(1,3) = c3;
B{1,4}(3,1) = c19;
B{1,4}(2,2) = c11;

B{1,5}(1,1) = c3;
B{1,5}(1,2) = c12;
B{1,5}(2,1) = c11;
B{1,5}(1,3) = c15;
B{1,5}(3,1) = c19;
B{1,5}(2,2) = c18;

B{1,6}(1,1) = c15;
B{1,6}(1,2) = c6;
B{1,6}(2,1) = c18;
B{1,6}(1,3) = c1;
B{1,6}(3,1) = c19;
B{1,6}(2,2) = c5;

end